<!DOCTYPE html> 
<html> 
	<head> 
        <title>ZenTXT</title> 
        <meta name="viewport" content="width=device-width, initial-scale=1"> 
        <link rel="stylesheet" href="js/jquery.mobile-1.0.1.min.css" />
        <script src="js/jquery-1.7.1.min.js"></script>
        <script src="js/jquery.mobile-1.0.1.min.js"></script>

        <script>
            function add_list_item(list_id, text, href) {
                if(text.length > 0) {
                    var el = '<li><a href="'+href+'">'+text+'</a></li>';
                    //el.page();
                    $("#file_list").append(el);
                    $('#file_list').listview('refresh');
                }
            }
            function load_files() {
                $("#file_list").children().remove();
                var url="/files";
                $.getJSON(url, function(data) {
                    $.each(data.file, function(index, file) {
                        //console.log(file);
                        url="/file?id=" + file.key
                        add_list_item('#file_list', file.name, url);
                    });
                });
            }
            function load_revisions() {
                $("#file_list").children().remove();
                var url="/revisions?file=" + "agpkZXZ-emVudHh0cgoLEgRGaWxlGAEM";
                $.getJSON(url, function(data) {
                    $.each(data.revision, function(index, revision) {
                        //console.log(file);
                        url="/rev?id=" + revision.key
                        add_list_item('#file_list', revision.date, url);
                    });
                });
            }

            $('#files').live('pageshow', function (event, data) {
                load_revisions();
                //load_files();
            });
        </script>
    </head> 
    <body> 
        <div data-role="page" id="home">

            <div data-role="header">
                <h1>ZenTXT</h1>
            </div><!-- /header -->

            <div data-role="content" >
                <a href="/suggestions">Suggestions</a>
                <a href="/files">Files</a>
                <a href="{{ login_url }}">Login</a>

                <p><a href="#files" data-role="button">Files</a></p>
                <p><a href="#popup"data-role="button" data-rel="dialog" data-transition="pop">Show page "popup" (as a dialog)</a></p>
            </div><!-- /content -->

            <div data-role="footer" data-theme="d">
                <h4>Page Footer</h4>
            </div><!-- /footer -->
        </div><!-- /page -->

        <div data-role="page" id="files" data-theme="a">
	        <div data-role="header">
		        <h1>Two</h1>
	        </div><!-- /header -->

	        <div data-role="content" data-theme="a">	
		        <h2>Files</h2>
                <ul data-role="listview" data-inset="true" data-filter="true" id="file_list">
	                <li><a href="#">Acura</a></li>
	                <li><a href="#">Audi</a></li>
	                <li><a href="#">BMW</a></li>
	                <li><a href="#">Cadillac</a></li>
	                <li><a href="#">Ferrari</a></li>
                </ul>
                <p><a href="#main" data-rel="back" data-role="button" data-inline="true" data-icon="back">Back to page "one"</a></p>
	        </div><!-- /content -->
	
	        <div data-role="footer">
		        <h4>Page Footer</h4>
	        </div><!-- /footer -->
        </div><!-- /page two -->

        <div data-role="page" id="popup">
        </div><!-- /page popup -->
    </body>
</html>

